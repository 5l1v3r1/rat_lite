language : cpp

matrix:
  include:
    - os: osx
    - os: linux
      env: VERSION=3.8 BUILD_TYPE=Debug CC=clang CXX=clang CXXFLAGS=-lstdc++
      compiler: clang
      dist: trusty
      sudo: required
      addons: &libcxx
        apt:
          packages:
            - libc++-dev
      
before_install:
  # Install the newest `cmake`.
  - if [ "${TRAVIS_OS_NAME}" = "osx" ]; then
      brew update && brew outdated boost || brew upgrade boost && brew install fltk openssl libjpeg-turbo && brew upgrade cmake || brew install cmake;
    elif [ "${TRAVIS_OS_NAME}" = "linux" ]; then
      wget https://cmake.org/files/v3.7/cmake-3.7.2-Linux-x86_64.sh;
      chmod u+x cmake-3.7.2-Linux-x86_64.sh;
      sudo ./cmake-3.7.2-Linux-x86_64.sh --skip-license --prefix=/usr/local;
    fi
  # Install a specific clang version.
  - if [ "${TRAVIS_OS_NAME}" = "linux" ] && [ "${CC}" = "clang" ] && [ -n "${VERSION}" ]; then
      wget -nv -O - http://llvm.org/apt/llvm-snapshot.gpg.key | sudo apt-key add -;
      sudo apt-add-repository -y "deb http://llvm.org/apt/trusty llvm-toolchain-trusty-${VERSION} main";
      sudo apt-get update -qq;
      sudo apt-get install -qq -y "clang-${VERSION}";
      sudo apt-get install -y libjpeg-turbo8-dev libboost-all-dev libfltk1.3-dev libxext-dev libx11-dev libxfixes-dev libxtst-dev;
    fi
  - ${CXX} --version

install:
  - mkdir build
  - cd build
  - cmake -DCMAKE_BUILD_TYPE=${BUILD_TYPE}
          -DOPENSSL_ROOT_DIR=/usr/local/opt/openssl/ ..
  - cmake --build .

script:
  - ctest -V
  
notifications:
  email: false
  
